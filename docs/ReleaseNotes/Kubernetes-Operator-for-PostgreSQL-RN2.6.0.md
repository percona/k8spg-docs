# Percona Operator for PostgreSQL 2.6.0

* **Date**

    February XX, 2025

* **Installation**

    [Installing Percona Operator for PostgreSQL](../System-Requirements.md#installation-guidelines) 

## Release Highlights

### PostgreSQL 17 support

PostgreSQL 17 is now supported by the Operator in addition to 13 - 16 versions. The appropriate images are now included into the [list of Percona-certified images](../images.md). See these blogposts ([1](https://www.percona.com/blog/encrypt-postgresql-data-at-rest-on-kubernetes/), [2](https://www.percona.com/blog/the-powerful-features-released-in-postgresql-17-beta-2/), [3](https://www.percona.com/blog/postgresql-17-two-small-improvements-that-will-have-a-major-impact/)) for details about the latest PostgreSQL 17 features with the added security and functionality improvements.

## New features

* {{ k8spgjira(628) }}: The custom `restore_command` [can be now passed](../backups-restore.md#use-custom-restore-command) to pgBackRest via the [patroni.dynamicConfiguration](../operator.md#patronidynamicconfiguration) Custom Resource option
* {{ k8spgjira(619) }}: New `backups.pgbackrest.jobs.backoffLimit` and `backups.pgbackrest.jobs.restartPolicy` Custom Resource options allow to retry backup in the backup Pod for a specified number of times before abandoning the Pod and creating the new one
* {{ k8spgjira(648) }}: PostgreSQL 17 is now supported by the Operator

## Improvements

* {{ k8spgjira(487) }}: New `spec.metadata.labels` and `spec.metadata.annotations` Custom Resource options allow setting labels and annotation globally for all Kubernetes objects created by the Operator
* {{ k8spgjira(554) }}: New `tlsOnly` Custom Resource option allows the user to enforce TLS connections for the database cluster
* {{ k8spgjira(586) }}: The new experimental `finalizers.delete-backups` finalizer (off by default) removes all backups of the cluster at cluster deletion event
* {{ k8spgjira(594) }}: Run DROP EXTENSION on extension deletion
* {{ k8spgjira(634) }}: The new `autoCreateUserSchema` Custom Resource option enhances the declarative user management by automatically creating per-user schemas 
* {{ k8spgjira(652) }}: Improve security and meet compliance requirements by using PostgreSQL images built based on Red Hat Universal Base Image (UBI) 9 instead of UBI 8
* {{ k8spgjira(689) }}: Document 2.5.0-cw (cluster-wide variant) availability in OpenShift Marketplace
* {{ k8spgjira(692) }}: Patroni versions 4.x are now supported by the Operator in addition to versions 3.x
* {{ k8spgjira(699) }}: The `pgvector` extension is now included within the PostgreSQL image used by the Operator
* {{ k8spgjira(701) }}: The `extensions.image` Custom Resource option is now optional, and can be omitted for builtin PostgreSQL extensions
* {{ k8spgjira(702) }}: A retry logic was implemented to fix intermittent Pod exec failures caused by timeouts (Thanks to dcaputo-harmoni for contribution)
* {{ k8spgjira(710) }}: It is now possible to completely disable backup functionality
* {{ k8spgjira(711) }}: The new [README.md  :octicons-link-external-16:](https://github.com/percona/percona-docker/blob/main/postgresql-containers/README.md) explains how to build your own images for the PostgreSQL cluster components used by the Operator

## Bugs Fixed

* {{ k8spgjira(637) }}: Fix a bug where restore was failing with "waiting for another restore to finish" if the pg-restore object of a previous unfinished restore was manually deleted
* {{ k8spgjira(638) }}: Fix a bug that caused flooding the logs with no completed backups found error at cluster initialization.
* {{ k8spgjira(645) }}: Fix a bug where creating sidecar containers for pgBouncer did not work
 {{ k8spgjira(681) }}: Fixed a bug where the "Last Recoverable Time" information field was missing from the output of the `kubectl get pg-backup` command due to misdetection cases

## Deprecation, Change, Rename and Removal

With the Operator versions prior to 2.6.0, [autogenerated TLS certificates](../TLS.md#allow-the-operator-to-generate-certificates-automatically) for all database clusters were based on the same generated root CA. Starting from 2.5.0, the Operator creates root CA on a per-cluster basis.


## Supported platforms

The Operator was developed and tested with PostgreSQL versions 13.18, 14.15, 15.10, 16.6, and 17.2. Other options may also work but have not been tested. The Operator 2.6.0 provides connection pooling based on pgBouncer 1.23.1 and high-availability implementation based on Patroni 4.0.3.

Percona Operators are designed for compatibility with all [CNCF-certified :octicons-link-external-16:](https://www.cncf.io/training/certification/software-conformance/) Kubernetes distributions. Our release process includes targeted testing and validation on major cloud provider platforms and OpenShift, as detailed below for Operator version 2.6.0:

* [Google Kubernetes Engine (GKE) :octicons-link-external-16:](https://cloud.google.com/kubernetes-engine) 1.29 - 1.31
* [Amazon Elastic Container Service for Kubernetes (EKS) :octicons-link-external-16:](https://aws.amazon.com) 1.29 - 1.32
* [OpenShift :octicons-link-external-16:](https://www.redhat.com/en/technologies/cloud-computing/openshift) 4.14.46 - 4.17.15
* [Azure Kubernetes Service (AKS) :octicons-link-external-16:](https://azure.microsoft.com/en-us/services/kubernetes-service/) 1.29 - 1.31
* [Minikube :octicons-link-external-16:](https://github.com/kubernetes/minikube) 1.35.0 with Kubernetes 1.32.0

This list only includes the platforms that the Percona Operators are specifically tested on as part of the release process. Other Kubernetes flavors and versions depend on the backward compatibility offered by Kubernetes itself.
