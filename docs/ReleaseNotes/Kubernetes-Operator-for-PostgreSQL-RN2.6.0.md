# Percona Operator for PostgreSQL 2.6.0

* **Date**

    February XX, 2025

* **Installation**

    [Installing Percona Operator for PostgreSQL](../System-Requirements.md#installation-guidelines) 

## Release Highlights


## New features

* {{ k8spgjira(628) }}: The custom `restore_command` [can be now passed](../backups-restore.md#use-custom-restore-command) to pgBackRest via the [patroni.dynamicConfiguration](../operator.md#patronidynamicconfiguration) Custom Resource option
* {{ k8spgjira(619) }}: New `backups.pgbackrest.jobs.backoffLimit` and `backups.pgbackrest.jobs.restartPolicy` Custom Resource options allow to retry backup in the backup Pod for a specified number of times before abandoning the Pod and creating the new one
* {{ k8spgjira(648) }}: PostgreSQL 17 is now supported by the Operator

## Improvements

* {{ k8spgjira(487) }}: New `spec.metadata.labels` and `spec.metadata.annotations` Custom Resource options allow setting labels and annotation globally for all Kubernetes objects created by the Operator
* {{ k8spgjira(554) }}: New `tlsOnly` Custom Resource option allows the user to enforce TLS connections for the database cluster
* {{ k8spgjira(586) }}: The new experimental `finalizers.delete-backups` finalizer (off by default) removes all backups of the cluster at cluster deletion event
* {{ k8spgjira(594) }}: Run DROP EXTENSION on extension deletion
* {{ k8spgjira(634) }}: The new `autoCreateUserSchema` Custom Resource option enhances the declarative user management,  Automatically create per-user schemas 
* {{ k8spgjira(639) }}: Add section on how to use walVolumeClaimSpec functionality.
* {{ k8spgjira(652) }}: Use ubi9 for all PG images
* {{ k8spgjira(653) }}: Add --force-conflicts option to kubectl apply --server-side when upgrade using Helm
* {{ k8spgjira(689) }}: Document 2.5.0-cw (cluster-wide variant) availability in OpenShift Marketplace
* {{ k8spgjira(692) }}: Add support for patroni v4
* {{ k8spgjira(699) }}: The `pgvector` extension is now included within the PostgreSQL image used by the Operator
* {{ k8spgjira(701) }}: Make spec.extensions.image optional
* {{ k8spgjira(702) }}: Fix pod exec failing intermittently with retry logic
* {{ k8spgjira(710) }}: Allow disabling backups
* {{ k8spgjira(711) }}: The new [README.md  :octicons-link-external-16:](https://github.com/percona/percona-docker/blob/main/postgresql-containers/README.md) explains how to build your own images for the PostgreSQL cluster components used by the Operator

## Bugs Fixed

* {{ k8spgjira(637) }}: Restore fails with "waiting for another restore to finish" if manually delete the pg-restore object
* {{ k8spgjira(638) }}: Handle "WALWatcher get latest backup" errors on cluster init
* {{ k8spgjira(641) }}: Add retention options into PG documentation
* {{ k8spgjira(645) }}: Sidecars for pgbouncer do not work
* {{ k8spgjira(693) }}: Documentation mentions that any operator versions could work with 3 previous versions of CRD and it's better to use current CRD and support last 3 versions of the operator instead
* {{ k8spgjira(679) }}: Fix typo in README.md
* {{ k8spgjira(681) }}: LatestRestorableTime does not appear

## Deprecation, Change, Rename and Removal

With the Operator versions prior to 2.6.0, [autogenerated TLS certificates](../TLS.md#allow-the-operator-to-generate-certificates-automatically) for all database clusters were based on the same generated root CA. Starting from 2.5.0, the Operator creates root CA on a per-cluster basis.


## Supported platforms

The Operator was developed and tested with PostgreSQL versions 13.18, 14.15, 15.10, 16.6, and 17.2. Other options may also work but have not been tested. The Operator 2.6.0 provides connection pooling based on pgBouncer 1.23.1 and high-availability implementation based on Patroni 4.0.3.

Percona Operators are designed for compatibility with all [CNCF-certified :octicons-link-external-16:](https://www.cncf.io/training/certification/software-conformance/) Kubernetes distributions. Our release process includes targeted testing and validation on major cloud provider platforms and OpenShift, as detailed below for Operator version 2.6.0:

* [Google Kubernetes Engine (GKE) :octicons-link-external-16:](https://cloud.google.com/kubernetes-engine) 1.29 - 1.31
* [Amazon Elastic Container Service for Kubernetes (EKS) :octicons-link-external-16:](https://aws.amazon.com) 1.29 - 1.32
* [OpenShift :octicons-link-external-16:](https://www.redhat.com/en/technologies/cloud-computing/openshift) 4.14.46 - 4.17.15
* [Azure Kubernetes Service (AKS) :octicons-link-external-16:](https://azure.microsoft.com/en-us/services/kubernetes-service/) 1.29 - 1.31
* [Minikube :octicons-link-external-16:](https://github.com/kubernetes/minikube) 1.35.0 with Kubernetes 1.32.0

This list only includes the platforms that the Percona Operators are specifically tested on as part of the release process. Other Kubernetes flavors and versions depend on the backward compatibility offered by Kubernetes itself.
